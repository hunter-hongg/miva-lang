# ğŸ“‹ Miva v0.0.4 Release Notes

> **Tagline**: From *usable* to *pleasant*  
> **Core Goals**: Improve developer experience Â· Optimize compilation efficiency  
> **Previous Version**: [v0.0.3](https://github.com/hunter-hongg/miva-lang/releases/tag/v0.0.3)

---

## ğŸ“Š Overview

| Feature Area        | v0.0.3               | v0.0.4                          | Type       |
|---------------------|----------------------|----------------------------------|------------|
| **Environment Vars**| System-only          | âœ… Project-level via `miva.toml`| New        |
| **Build Targets**   | Executables only     | âœ… Dynamic library support       | New        |
| **Incremental Build**| âŒ Not supported     | âœ… File-level incremental build  | New        |
| **Assignment Checks**| âŒ None              | âœ… Static assertions for non-`Copy` types | New (migration needed) |
| **Test Runner**     | Run all tests        | âœ… Filter by file or test name   | New        |
| **Build Output**    | Plain text           | âœ… Colorized + structured output | Improved   |

> ğŸ’¡ **Note**: Some new features (e.g., assignment checks) may require minor code adjustments. See the migration guide for details.

---

## âœ¨ Detailed Features

### 1. Environment Variable Management ğŸ”§  
**Project-scoped configuration, overrides global defaults**

You can now declare project-specific environment variables in `miva.toml`, which take precedence over system-wide values.

```toml
# miva.toml
[env]
MIVA_STD = "./std"           # Standard library path
MIVA_INCLUDE = "./include"   # Header search path
MIVA_DEBUG = "true"          # Enable debug mode
```

Running `miva init` auto-generates sensible defaults:
```toml
[env]
MIVA_STD = "."  # Resolves to project root
```

**Precedence order**:  
`miva.toml` > system environment variables > compiler defaults

---

### 2. Library Compilation Support ğŸ“¦  
**Let other languages call your Miva code**

Introducing `--lib` mode to build cross-platform dynamic libraries:

```bash
miva build              # For `lib` projects: outputs .so / .dll / .dylib
miva build              # For `bin` projects: outputs executable
# miva build --static  # Static libraries (planned)
```

Configuration example:
```toml
[lib]
name = "mylib"
type = "lib"  # Options: lib | static (latter coming soon)
```

Output structure:
```
build/
â”œâ”€â”€ mylib.so      # Linux
â”œâ”€â”€ mylib.dll     # Windows
â””â”€â”€ mylib.dylib   # macOS
```

---

### 3. Incremental Compilation âš¡  
**Change one line, not recompile a hundred**

A SHA256-based incremental build system skips unchanged files, dramatically speeding up iteration.

**Workflow**:
```
Source file â†’ Compute hash â†’ Compare cache â†’ Skip or rebuild
```

Cache layout:
```
build/cache/
â”œâ”€â”€ manifest.json   # File hash registry
â”œâ”€â”€ src/            # Compiled objects (.o)
â””â”€â”€ deps/           # Dependency graph (reserved for future use)
```

**Performance gains** (QEMU VM, 4 cores, 8GB RAM):

| Project Size | Full Build (v0.0.3) | Incremental (v0.0.4) | Speedup |
|--------------|---------------------|----------------------|---------|
| 10 files     | 2.0 s               | 0.5 s                | 75%     |
| 100 files    | 20 s                | 3 s                  | 85%     |
| 1000 files   | 200 s               | 15 s                 | 92%     |

---

### 4. Static Assignment Checks ğŸ›¡ï¸  
**No implicit copiesâ€”explicit ownership only**

For non-`Copy` types (e.g., `string`, `box<T>`), the compiler injects `static_assert` in the C++ backend to prevent accidental copying.

**Miva source**:
```miva
x := get_string()  // string is non-Copy
y := x             // âŒ Compile error!
```

**Generated C++**:
```cpp
auto x = get_string();
static_assert(is_copyable_v<decltype(x)>,
    "Type 'string' is not copyable. Use 'move x' or 'clone x' explicitly.");
auto y = x;  // Triggers assertion failure
```

**Copyability rules**:
- âœ… Primitive types (`int`, `bool`, `f64`): copyable
- âŒ Owned types (`string`, `[T]`, `box<T>`): not copyable
- ğŸ“¦ Custom structs: copyable only if all fields are copyable

> âš ï¸ **Migration note**: Existing code that implicitly copies non-`Copy` types must be updated to use `move x` or `clone x`.

---

### 5. Test Runner Improvements ğŸ§ª  
**Run exactly what you needâ€”fast**

Filter tests by filename or pattern to avoid waiting for full suites.

```bash
miva test               # Run all tests
miva test io            # Run only tests in src/io.miva
miva test --verbose     # Show detailed logs (including pass/fail status)
```

---

### 6. Polished Output ğŸ¨  
**Clear, friendly, and focused**

- Color-coded success/failure indicators (green âœ“ / red âœ—)
- Syntax-highlighted error locations
- Automatic build duration reporting

> ğŸŒˆ Support for `NO_COLOR=1` to disable colors (CI-friendly) â€” coming soon.

---

## ğŸ“ Whatâ€™s Next

- **GitHub Issues**: Found a bug or have a suggestion? ğŸ‘‰ [Open an issue](https://github.com/hunter-hongg/miva-lang/issues)  
- **v0.0.5 Preview**: Expected early March 2026, featuring **initial macro system** and **basic LSP support**

---

> **The Miva Philosophy**:  
> Explicit > Implicit  
> Safe > Convenient  
> Predictable > Magical  
> Verifiable > Assumed  

Thank you to every early explorer.  
The world is waiting for the first program written in Miva. âœ¨